<!DOCTYPE html>
<html lang="en">
	<head>
		 
		<script async src="https://www.googletagmanager.com/gtag/js?id=UA-23296419-22"></script>
		<script>
		window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());
		gtag('config', 'UA-23296419-22');
		</script>
		 

		<title>Introduction to TCP: Transmission Control Protocol - Internal Pointers</title>

		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<meta name="author" content="Monocasual Laboratories">
		<meta name="description" content="One of the most important, high-level protocols in the Internet Protocol Suite. ">
		<meta name="keywords" content="networks,internet,TCP,IP">
		<meta name="copyright" content="2015-2024 Monocasual Laboratories">
		<meta name="application-name" content="Internal Pointers">
		<meta name="google-site-verification" content="d6wzhBnnEXNHg7kty5SNXVBKd4e29wUFP69SROd-3eI" />

		<meta property="og:title" content="Introduction to TCP: Transmission Control Protocol" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.internalpointers.com/post/introduction-tcp-transmission-control-protocol" />
<meta property="og:image" content="https://raw.githubusercontent.com/monocasual/internalpointers-files/master/2021/07/network5/tcp-protocol.png" />
<meta property="og:image:width" content="1200" />
<meta property="og:image:height" content="900" />
<meta property="og:site_name" content="Internal Pointers" />
<meta property="og:description" content="One of the most important, high-level protocols in the Internet Protocol Suite. " />
<meta name="twitter:card" content="summary" />
<meta name="twitter:url" content="https://www.internalpointers.com/post/introduction-tcp-transmission-control-protocol" />
<meta name="twitter:title" content="Introduction to TCP: Transmission Control Protocol" />
<meta name="twitter:description" content="One of the most important, high-level protocols in the Internet Protocol Suite. " />
<meta name="twitter:image" content="https://raw.githubusercontent.com/monocasual/internalpointers-files/master/2021/07/network5/tcp-protocol.png" />

		<link rel="icon" href="/img/favicon.ico">
		<link rel="apple-touch-icon-precomposed" href="/img/favicon-152.png">
		<link rel="stylesheet" href="/main-1.4.0.css">

				
		<script defer src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
		<script defer src="//cdnjs.cloudflare.com/ajax/libs/js-cookie/2.2.1/js.cookie.min.js"></script>
		<script defer src="/main-1.4.0.js"></script>

		

	</head>
	<body>
		<div class="ip-follow-us-popup">

    <div class="ip-follow-us-popup__side">
        <img src="/img/facebook-like-thumb.svg" alt="Like it!">
    </div>

    <div class="ip-follow-us-popup__header">
        <p>Join us on Facebook!</p>
    </div>

    <div class="ip-follow-us-popup__body">
        <div class="ip-follow-us-popup__body__ok">
        <img src="/img/facebook-like-thumb.svg" alt="Like it!">
        </div>
    </div>

    <div class="ip-follow-us-popup__footer">
        <div><a href="#" class="ip-follow-us-popup__footer__nope">Nope, thanks anyway.</a></div>
    </div>

</div>		<div class="ip-cookie-banner">
    <div class="ip-container">
        <p>We use cookies to personalise content and ads, to provide social media features and to analyse our traffic. By using our site, you acknowledge that you have read and understand our <a href="{{ url('/privacy/') }}">Privacy Policy</a>, and our <a href="{{ url('/tos/') }}">Terms of Service</a>. Your use of this site is subject to these policies and terms. | <a href="#" class="ip-cookie-banner__close">ok, got it</a></p>
    </div>
</div>		<div class="ip-header">
	<div class="ip-container">
		<div class="ip-header__logo">
			<a href="/">**internal / pointers</a>
		</div>
		<div class="ip-header__links">
			<ul>
				<li><a href="/rss">rss</a></li>
				<li><a href="/about">about</a></li>
			</ul>
		</div>
	</div>
</div>

<div class="ip-sub-header">
</div>
		<div class="ip-body">

	<div class="ip-container">

		<div class="ip-post">

			<div class="ip-post__info">
				<p>— Written by Triangles on August 03, 2021 
								• updated on September 09, 2021  
								• ID 91 —</p>
			</div>

			<div class="ip-post__title">
				<h1>Introduction to TCP: Transmission Control Protocol</h1>
			</div>

			<div class="ip-post__intro">
				<p>One of the most important, high-level protocols in the Internet Protocol Suite. </p>
			</div>

						<div class="ip-post__other-box">
				<div class="ip-post__other-box__section-title">Other articles from this series</div>

				<ul class="ip-post__other-box__post-list">
														<li>
						<p>
							<span class="title">
								<a href="/post/introduction-computer-networks.html">Introduction to computer networks  </a>
							</span> —
							<span class="intro">A bird's-eye view on the art of resource sharing from one computer to another. </span>
						</p>
					</li>
																			<li>
						<p>
							<span class="title">
								<a href="/post/understanding-internet.html">Understanding the Internet </a>
							</span> —
							<span class="intro">“Is that thing still around?” — Homer Simpson</span>
						</p>
					</li>
																			<li>
						<p>
							<span class="title">
								<a href="/post/introduction-tcp-ip-protocol.html">Introduction to the TCP/IP protocol</a>
							</span> —
							<span class="intro">The official rules that allow computers to communicate over the Internet.</span>
						</p>
					</li>
																			<li>
						<p>
							<span class="title">
								<a href="/post/introduction-ip-internet-protocol.html">Introduction to IP: the Internet Protocol</a>
							</span> —
							<span class="intro">From routing to IP addressing, a look at the protocol that gives life to the Internet.</span>
						</p>
					</li>
																												<li>
						<p>
							<span class="title">
								<a href="/post/network-programming-beginners-overview.html">Network programming for beginners: introduction to sockets </a>
							</span> —
							<span class="intro">A theoretical look at one of the most popular programming tools for exchanging data over computer networks. </span>
						</p>
					</li>
																			<li>
						<p>
							<span class="title">
								<a href="/post/making-http-requests-sockets-python.html">Making HTTP requests with sockets in Python </a>
							</span> —
							<span class="intro">A practical introduction to network programming, from socket configuration to network buffers and HTTP connection modes. </span>
						</p>
					</li>
													</ul>
			</div>
			
			<div class="ip-post__body">
				<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1778432007040046"
     crossorigin="anonymous"></script>
<!-- internalpointers responsive -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-1778432007040046"
     data-ad-slot="1269254897"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script><p>Welcome to the 5th episode of the <a href="https://internalpointers.com/post-group/networking-101">Networking 101 series</a>! In the previous chapter I talked about the <a href="https://internalpointers.com/post/introduction-ip-internet-protocol">Internet Protocol</a>, a fundamental piece in the <a href="https://internalpointers.com/post/introduction-tcp-ip-protocol">Internet Protocol Suite</a> that gives life to the Internet as we know it. The Internet Protocol introduces important concepts such as <strong>routing</strong> and <strong>IP addresses</strong> that allow two or more computers located on different networks to exchange data.</p>
<p>As seen in the previous episode, communicating through the Internet Protocol is straightforward: split your message into small chunks of data (<strong>datagrams</strong>) and send them to the recipient's computer (<strong>host</strong>) connected to a network. <strong>Routers</strong> will do the job of delivering your datagrams to the correct destination by passing them around until the target host is reached. The Internet Protocol works like the postal service: you write the address on the letter, post it and hope it will safely reach the destination.</p>
<p>This way of exchanging data is essential for the Internet to work correctly, but it's too limited for a practical communication: will the recipient receive the data? What if it gets corrupted or lost along the way? In case of multiple datagrams, how to make sure they are received in the correct order? The <strong>Transmission Control Protocol (TCP)</strong> exists to answer all those questions — and much more.</p>
<p>The Transmission Control Protocol belongs to the Transport layer (#3) in the Internet Protocol Suite and it's one of the most important protocols in the entire stack. It makes use of the Internet Protocol as a foundation and adds many features on top of it.</p>
<div class="ip-img">
<img src="https://raw.githubusercontent.com/monocasual/internalpointers-files/master/2021/07/network5/tcp-protocol-in-stack.png" alt="TCP in TCP/IP stack">
<div class="caption">1. The Transmission Control Protocol belongs to layer 3 of the TCP/IP protocol stack.</div>
</div><p>TCP has been designed by the <strong>Internet Engineering Task Force (IETF)</strong> and you can find the original specification <a href="https://datatracker.ietf.org/doc/html/rfc793">here</a>, along with additional updates (<a href="https://datatracker.ietf.org/doc/html/rfc1122">1</a>, <a href="https://datatracker.ietf.org/doc/html/rfc3168">2</a>, <a href="https://datatracker.ietf.org/doc/html/rfc6093">3</a>, <a href="https://datatracker.ietf.org/doc/html/rfc6528">4</a>).</p>
<h2>TCP main properties: an overview</h2>
<p>The Transmission Control Protocol introduces several improvements over the low-level Internet Protocol, both conceptually and technically:</p>
<ul>
<li><p>TCP is <strong>connection-oriented</strong> — a connection must be set up between two or more hosts before exchanging data;</p>
</li>
<li><p>TCP follows the <strong>client-server model</strong> — a <em>hierarchy</em> is established between two or more hosts that want to communicate. The server provides data to clients;</p>
</li>
<li><p>data transfer is <strong>ordered</strong> — if you send A, B and then C, TCP guarantees you that the recipient will receive A first, B and then C in that exact order;</p>
</li>
<li><p>lost data is <strong>retransmitted</strong> — TCP makes sure the entire block of information reaches the target host. If a portion of it is lost, TCP issues a retransmission;</p>
</li>
<li><p>data is validated through <strong>error correction</strong> mechanisms — data might get corrupted along the way. TCP is capable of detecting and fixing errors;</p>
</li>
<li><p><strong>flow</strong> and <strong>congestion</strong> control — a computer in a slow network might be quickly overwhelmed by another one that sends data from a fast network. TCP has complex strategies to regulate how fast or slow data should be sent between hosts.</p>
</li>
</ul>
<p>TCP is a robust and reliable protocol for exchanging data, but on the other hand it increases the level of complexity if compared to the simpler IP. I will take a look at those intricacies in the last part of this article.</p>
<h3>TCP in the real world</h3>
<p>As IP is the foundation of TCP, so several protocols from the upper layers in the Internet Protocol Stack are based on TCP. For example, the <strong>Hypertext Transfer Protocol (HTTP)</strong> is one of the most important protocols for browsing the web. The page you are reading right now has been obtained by your browser thanks to a TCP connection established by HTTP to the web server that stores this website. Two other important TCP-based protocols are the <strong>File Transfer Protocol (FTP)</strong> — used to transfer files between computers and the <strong>Secure Shell Protocol (SSH)</strong> — used to connect to another computer in a secure way.</p>
<p>The protocols mentioned above (and many others) need the robustness and reliability provided by TCP in order to work correctly. For example, TCP makes sure that the text you are reading right now is fetched correctly from the HTTP server, in the correct order, without missing pieces or damaged parts.</p>
<p>Like any other protocol, TCP is just a set of rules written on paper: the actual implementation is done by operating systems through special entities called <strong>network sockets</strong>. A network socket is a programming object that allows two hosts to send and receive data. I will explore network sockets later on in this series when I will get my hands dirty with network programming.</p>
<h2>TCP is connection-oriented</h2>
<p>If the Internet Protocol looks like the postal service, using the Transmission Control Protocol is like making a phone call: you need to establish a connection before being able to talk. Concretely, the process is made up of three phases: 1) create a connection between the hosts; 2) transfer the data; 3) close the connection. The key point of a TCP connection is the ability to transmit data in both directions at the same time: from sender to receiver and vice versa. This is known as a <strong>full-duplex</strong> data transmission.</p>
<h3><a id="client-server-model"></a>The client-server model</h3>
<p>During a TCP connection, the host that provides data is the <strong>server</strong>, while hosts that receive it are the <strong>clients</strong>. For example, this website is stored in a computer connected to a network located somewhere on the Internet. When you ask your browser to navigate this website, the browser itself establishes a TCP connection between your computer and the computer where the website is stored.</p>
<p>Your computer is the client, while the computer containing the website data is the server. The server sends the text content to the client, while at the same time the client sends information to the server about specific instructions such as which page to get, how to transfer data and so on. This is the full-duplex transmission in action.</p>
<p>Since TCP is based on IP, you need to specify the IP address of the server you want to connect to. On top of that, TCP uses special numbers, called <strong>ports</strong>, to determine the type of <em>service</em> you want from the server. For example, port 80 is used to exchange web pages such as this one; port 23 is for transferring files and so on. A server may be able to offer multiple services, thus having multiple ports available.</p>
<h3>Establishing and closing connections</h3>
<p>A TCP connection is established by following three steps, also known as <strong>the three-way handshake</strong>. Two hosts that want to connect through TCP must first exchange a set of special messages — <code>SYN</code>, <code>SYN-ACK</code> and <code>ACK</code> — in the correct order. If the negotiation is successful, the connection takes place and the two hosts can start sharing data.</p>
<p>A TCP connection is closed through another negotiation made of four steps called <strong>four-way handshake</strong>. The host that wants to terminate the connection notifies the other end, which in turn replies back. The connection is closed successfully after the exchange of a set of special messages — <code>FIN</code> and <code>ACK</code> — in the correct order. I will take a closer look at the TCP handshakes and actual TCP communication in the upcoming network programming part of this series.</p>
<h3><a id="how-data-looks-like-with-tcp"></a>How data looks like with TCP</h3>
<p>In <a href="https://internalpointers.com/post/introduction-tcp-ip-protocol">the third chapter of this series</a> I mentioned how the Internet Protocol Suite wants the data to be split into chunks: TCP calls those chunks <strong>segments</strong>.  Everything that is send over a TCP connection, from the handshakes described above to the actual data, is contained into a TCP segment. Segments are generated by programs from upper layers in the stack that make use of TCP.</p>
<p>A TCP segment is made of two parts:</p>
<ul>
<li>the <strong>header</strong> — contains routing information: source port, destination port and many other technical details;</li>
<li>the <strong>data section</strong> — a portion of the message to be sent. </li>
</ul>
<div class="ip-img">
<img src="https://raw.githubusercontent.com/monocasual/internalpointers-files/master/2021/07/network5/tcp-segment.png" alt="A TCP segment">
<div class="caption">2. TCP makes use of IP for the delivery by putting each TCP segment into an IP datagram's body.</div>
</div><p>The whole TCP segment is then <em>fitted into</em> an IP datagram's body, as seen in the picture above. Since TCP is based on IP, it uses IP datagrams to carry data around the Internet according to the IP routing mechanisms seen in <a href="https://internalpointers.com/post/introduction-ip-internet-protocol">the previous episode</a>.</p>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1778432007040046"
     crossorigin="anonymous"></script>
<!-- internalpointers responsive -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-1778432007040046"
     data-ad-slot="1269254897"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script><h2>How TCP improves IP</h2>
<p>As I said before, TCP adds lots of improvements over the bare-bone IP: let's take a quick look.</p>
<h3>Ordered data transfer</h3>
<p>Data transmission at lower levels of the Internet protocol stack is messy: IP datagrams may be delivered out of order. For this reason, each TCP segment has a special field in the header called <strong>sequence number</strong>. This field contains a number, generated by the sender, that gets incremented every time a new segment is sent. The receiver uses such information to identify the order of the segments received and reconstruct the correct sequence.</p>
<h3>Lost segments retransmission</h3>
<p>IP datagrams may be lost too. The receiver sends a special message (<code>ACK</code>) to the sender to inform it when a segment has been received. If the sender doesn't receive the confirmation message, it interprets it as a segment lost on the receiver side and tries to send it back again.</p>
<p>There are several techniques outlined by TCP to detect losses and retransmit data. For example, a timer called <strong>Retransmission Timeout (RTO)</strong> is used by the sender to monitor missing confirmations by the receiver. If the receiver doesn't send the special <code>ACK</code> within a certain time frame, the sender resends the segment. A more advanced trick known as <a href="https://en.wikipedia.org/wiki/TCP_congestion_control#Fast_retransmit"><strong>Fast-Retransmit</strong></a> is based on duplicate <code>ACK</code> messages sent back by the receiver when a missing datagram is detected.</p>
<h3>Error-free data transfer</h3>
<p>Each TCP segment contains in the header the <strong>Checksum</strong> field, a special number used to determine if the packet is valid or corrupted. The checksum is calculated by the sender using a specific algorithm, then stored in the header and sent to the receiver. The receiver computes the checksum on the received segment using the same algorithm as the sender and compares its value to the checksum passed in the header. If the values do not match, the segment is rejected.</p>
<h3>Data flow and congestion control</h3>
<p>TCP is designed to adapt to hosts and networks with different speeds. TCP's <strong>flow control</strong> is a mechanism where the receiver tells the sender how much data it is capable to process, so that the sender can adjust its rate accordingly. TCP's flow control is based on the <a href="https://en.wikipedia.org/wiki/Sliding_window_protocol"><strong>Sliding Window protocol</strong></a>, an algorithm used to keep track of how much data the receiver has got from the sender. When the receiver has its local buffer full of data — <em>the window is full</em> according to the algorithm's jargon —, the sender must wait.</p>
<p>TCP can also prevent <strong>network congestion</strong>: a situation where a host processes more data that it can handle. When a network is congested, data is delayed or lost and new connections cannot be established. TCP employs <a href="https://en.wikipedia.org/wiki/TCP_congestion_control#Algorithms">several algorithms</a> to prevent that, especially in modern implementations. The core idea is to keep the data flow below a rate that would trigger congestion. This is probably the trickiest part of TCP.</p>
<h2>TCP may cause high latency</h2>
<p>All the good stuff mentioned above makes TCP a very accurate protocol: data will hardly be lost in a TCP connection. However, waiting for out-of-order messages or retransmission of missing pieces may take time. For this reason, TCP adds <strong>latency</strong>: a time delay between a user action and the resulting response.</p>
<p>High latency is not a big problem with non-real-time applications: you can comfortably wait few milliseconds to fully obtain a web page from a server. On the other hand, TCP is not suitable for things that require a fast response, such as phone/video calls over the Internet or online games. For such applications, <strong>User Datagram Protocol (UDP)</strong> is usually recommended instead. I will dig into UDP in one of the next episodes of this series.</p>
<h2>What's next?</h2>
<p>I've spent the last five chapters exploring the theory behind the modern Internet. It's now time to put in practice what I've learned so far and see how all those protocols work in the real world: enter network programming, the art of writing apps that talk to eachother over a network. See you in the next episode!</p>
<h2>Sources</h2>
<p><a href="https://en.wikipedia.org/wiki/Transmission_Control_Protocol">Wikipedia — Transmission Control Protocol</a><br>
<a href="https://en.wikipedia.org/wiki/Connection-oriented_communication">Wikipedia — Connection-oriented communication</a><br>
<a href="https://en.wikipedia.org/wiki/TCP_congestion_control">Wikipedia — TCP congestion control</a><br>
<a href="https://en.wikipedia.org/wiki/Latency_%28engineering%29">Wikipedia — Latency (engineering)</a><br>
<a href="https://www.khanacademy.org/computing/computers-and-internet/xcae6f4a7ff015e7d:the-internet/xcae6f4a7ff015e7d:transporting-packets/a/transmission-control-protocol--tcp">Khan Academy — Transmission Control Protocol (TCP)</a><br>
<a href="https://gafferongames.com/post/virtual_connection_over_udp/">Gaffer On Games — Virtual Connection over UDP</a><br>
<a href="https://www.inetdaemon.com/tutorials/internet/tcp/3-way_handshake.shtml">inetdaemon.com — TCP 3-Way Handshake (SYN,SYN-ACK,ACK)</a><br>
<a href="https://packetlife.net/blog/2010/jun/7/understanding-tcp-sequence-acknowledgment-numbers/">packetlife.net — Understanding TCP Sequence and Acknowledgment Numbers</a><br>
<a href="https://www.isi.edu/nsnam/DIRECTED_RESEARCH/DR_WANIDA/DR/JavisInActionFastRetransmitFrame.html">Javis in action — Fast-Retransmit Algorithm</a></p>
			</div>


			<div class="ip-post__tags">
								<a class="ip-tag" href="/tag/networks">networks</a>
				 • 								<a class="ip-tag" href="/tag/internet">internet</a>
				 • 								<a class="ip-tag" href="/tag/tcp">TCP</a>
				 • 								<a class="ip-tag" href="/tag/ip">IP</a>
											</div>

			<div class="ip-post__neighbor-posts">
								<div class="ip-post__neighbor-posts__prev">
					<div class="ip-post__neighbor-posts__prev__label">
						previous article
					</div>
					<div class="ip-post__neighbor-posts__prev__title">          
						<a href="/post/introduction-ip-internet-protocol.html">Introduction to IP: the Internet Protocol</a>
					</div>
				</div>
								
								<div class="ip-post__neighbor-posts__next">
					<div class="ip-post__neighbor-posts__next__label">
						next article
					</div>
					<div class="ip-post__neighbor-posts__next__title">          
						<a href="/post/network-programming-beginners-overview.html">Network programming for beginners: introduction to sockets </a>
					</div>
				</div>
							</div>
			
						<div class="ip-post__comments">
				<div class="ip-post__comments__title">
					comments
				</div>
				
							</div>
			
			<div class="ip-post__social-tools">
				<div class="ip-post__social-tools__title">
					share!
				</div>
				<div class="ip-post__social-tools__twitter item"></div>
			</div>

		</div>

	</div>

</div>

		<div class="ip-footer">
	<div class="ip-container">
		© 2015-2024 — Monocasual Laboratories — 
		<a href="/tos" rel="nofollow">terms of service</a> — 
		<a href="/privacy" rel="nofollow">privacy policy</a> — 
		<a href="/about">about</a> — 
		<a href="/rss">RSS feed</a>
	</div>
</div>
	</body>
</html>

